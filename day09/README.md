Writing this while the snow falls outside. It's quite nice, unlike this solution :)

Still, the rule of thumb of AoC to avoid premature optimisation holds fast - I
considered using a parser generator, but then would have needed to get into the
guts of it for part 2.
